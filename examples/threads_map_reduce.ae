pub func worker(arg: i64) -> i32 {
    return (i32)arg;
}

pub func main() -> i32 {
    let h1: i64 = spawn("worker", 101);
    let h2: i64 = spawn("worker", 202);
    let r1: i32 = join(h1);
    let r2: i32 = join(h2);
    let s: i32 = r1 + r2;
    let h3: i64 = spawn("worker", 9999);
    let ok: i32 = destroy(h3);
    println("map_reduce");
    return s;
}
